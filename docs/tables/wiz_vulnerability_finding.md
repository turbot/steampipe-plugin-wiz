# Table: wiz_vulnerability_finding

The `wiz_vulnerability_finding` table can be used to list all vulnerabilities that Wiz scanner detected on the cloud resources.

**Note**: The table can limit a large dataset; which can increase the query execution time. It is recommended that queries to this table should include (usually in the `where` clause) at least one of these columns:

- `detection_method`
- `has_cisa_kev_exploit`
- `has_exploit`
- `severity`
- `status`
- `vulnerability_external_id`

## Examples

### Basic info

```sql
select
  vulnerable_asset ->> 'name' as resource_name,
  name as vulnerability,
  detailed_name,
  severity,
  fixed_version,
  detection_method,
  has_exploit,
  vulnerable_asset ->> 'subscriptionId' as subscription
from
  wiz_vulnerability_finding;
```

### List resources with high-severity known public exploit vulnerabilities

```sql
select
  vulnerable_asset ->> 'name' as resource_name,
  name as vulnerability,
  detailed_name,
  severity,
  fixed_version,
  detection_method,
  has_exploit,
  vulnerable_asset ->> 'subscriptionId' as subscription
from
  wiz_vulnerability_finding
where
  has_exploit
  and severity = 'HIGH';
```

### List high severity findings which are fixed

```sql
select
  vulnerable_asset ->> 'name' as resource_name,
  name as vulnerability,
  detailed_name,
  severity,
  fixed_version,
  detection_method,
  has_exploit,
  vulnerable_asset ->> 'subscriptionId' as subscription
from
  wiz_vulnerability_finding
where
  severity = 'HIGH'
  and fixed_version is not null;
```

### List high severity findings which are not resolved

```sql
select
  f.vulnerable_asset ->> 'name' as resource_name,
  f.name as vulnerability,
  f.detailed_name,
  f.severity,
  f.fixed_version,
  f.detection_method,
  f.has_exploit,
  s.name as subscription
from
  wiz_vulnerability_finding as f
  left join wiz_subscription as s on s.id = vulnerable_asset ->> 'subscriptionId'
where
  f.severity = 'HIGH'
  and f.status = 'UNRESOLVED'
  and f.has_exploit
  and f.has_cisa_kev_exploit;
```
